---
import type { Page } from 'astro'
import Layout from '../../layouts/layout.astro'
import {
  Nav,
  NavButtonGroup,
  NavNextButton,
  NavPrevButton,
  NavStatus,
} from '@components/nav'
import { Books } from '@components/books'
import { getReleasedBooks, type BookWithAuthors } from '@lib/data'

type Props = {
  page: Page<BookWithAuthors>
}

export async function getStaticPaths({ paginate }) {
  const data = await getReleasedBooks()
  data.reverse()

  return paginate(data, { pageSize: 20 })
}

export const prerender = true

const { page } = Astro.props
---

<Layout title={`만화 리스트 - ${page.currentPage}페이지 | managn`}>
  <Books data={page.data} />
  <Nav>
    <NavStatus lastPage={page.lastPage} currentPage={page.currentPage} />
    <NavButtonGroup>
      <NavPrevButton href={page.url.prev} />
      <NavNextButton href={page.url.next} />
    </NavButtonGroup>
  </Nav>
</Layout>
